import{j as e,r as a}from"./client-DAUkLRV6.js";import{Q as Y,a as Q}from"./createLucideIcon-C4Jmhpft.js";import q from"./UnityWithLoading-DbTRbRg-.js";import{N as J,C as Z,R as $,L as H,D as X,a as ee,M as oe,u as se,b as ie,c as ne,d as te,S as ae,e as re,f as le,g as de,h as ce,i as ge,j as pe,k as he,l as we,T as me}from"./TurnstileProvider--U56YGUH.js";import{U as ue}from"./UserContext-BpQKg0jV.js";import{u as Ce,m as Me,g as ye,b as fe,p as Se,v as ve,w as Oe,a as M,x as xe,y as Ae,c as je,E as Le,N as Ue,C as De,$ as Pe}from"./index-BpOnca1f.js";window.showToast=Ce;const Re=new Y({defaultOptions:{queries:{staleTime:5*60*1e3,retry:1}}});function Ee({version:g,dailyStreak:p,unityFiles:h}){const{showView:n,hideView:w,currentView:t}=se(),{showLoginModal:y,showRegisterModal:f,showChangePasswordModal:S,closeLoginModal:m,closeRegisterModal:u,closeChangePasswordModal:v,openLoginModal:r,openRegisterModal:l}=Se(),{showFusionDecisionModal:C}=ie(),{openModal:d}=ne(),{isTransferModalOpen:O,closeTransferModal:x,isSellModalOpen:A,closeSellModal:j,isBuyModalOpen:L,closeBuyModal:U,isRemovedItemsModalOpen:D,closeRemovedItemsModal:P,isSorryPopupOpen:Ie,closeSorryPopup:We,isCreateCoinFlipModalOpen:R,closeCreateCoinFlipModal:E,isCrateShopModalOpen:I,closeCrateShopModal:W,isCrateOpenModalOpen:N,closeCrateOpenModal:G}=ve(),{isBuyConfirmModalOpen:z,closeBuyConfirmModal:T,isCancelConfirmModalOpen:V,closeCancelConfirmModal:B}=Oe(),{isOpen:K,ticketUuid:F,closeModal:b}=te();return a.useEffect(()=>{window.showSettings=()=>{console.log("[AppWithUnity] showSettings called"),sessionStorage.removeItem("settingsInitialSection"),n("settings")},window.showClans=()=>{console.log("[AppWithUnity] showClans called"),sessionStorage.setItem("settingsInitialSection","clans"),n("settings")},window.showReleaseLogs=()=>{console.log("[AppWithUnity] showReleaseLogs called"),n("release-notes")},window.showLevelProgress=()=>{console.log("[AppWithUnity] showLevelProgress called"),n("level-progress")},window.hideOverlay=()=>{console.log("[AppWithUnity] hideOverlay called");const o=t;w(),window.unityInstance&&(o==="settings"?window.unityInstance.SendMessage(">>>JAVASCRIPT BRIDGE<<<","OnSettingsClosed"):o==="release-notes"?window.unityInstance.SendMessage("GameManager","OnReleaseNotesClosed"):o==="level-progress"&&window.unityInstance.SendMessage("GameManager","OnLevelProgressClosed"))},window.hideSettings=window.hideOverlay,window.hideLevelProgress=window.hideOverlay,window.showSettingsLogin=()=>{var o,s,i;if(console.log("[AppWithUnity.showSettingsLogin] ðŸš€ UNITY CALLED showSettingsLogin!"),console.log("[AppWithUnity.showSettingsLogin] Current hostname:",window.location.hostname),console.log("[AppWithUnity.showSettingsLogin] Is CrazyGames?",window.location.hostname.includes("crazygames.com")),window.location.hostname.includes("crazygames.com")){console.log("[AppWithUnity.showSettingsLogin] ON CRAZYGAMES - Triggering SDK auth!"),(i=(s=(o=window.CrazyGames)==null?void 0:o.SDK)==null?void 0:s.user)!=null&&i.showAuthPrompt?(window.CrazyGames.SDK.user.showAuthPrompt(),console.log("[AppWithUnity.showSettingsLogin] Called CrazyGames.SDK.user.showAuthPrompt()")):console.error("[AppWithUnity.showSettingsLogin] CrazyGames SDK not available");return}console.log("[AppWithUnity.showSettingsLogin] NOT on CrazyGames - Opening regular modal"),r(),console.log("[AppWithUnity.showSettingsLogin] openLoginModal call complete")},window.showSettingsRegister=()=>{var o,s,i;if(console.log("[AppWithUnity.showSettingsRegister] Called!"),console.log("[AppWithUnity.showSettingsRegister] Hostname:",window.location.hostname),window.location.hostname.includes("crazygames.com")){console.log("[AppWithUnity.showSettingsRegister] ON CRAZYGAMES - Triggering SDK auth!"),(i=(s=(o=window.CrazyGames)==null?void 0:o.SDK)==null?void 0:s.user)!=null&&i.showAuthPrompt?(window.CrazyGames.SDK.user.showAuthPrompt(),console.log("[AppWithUnity.showSettingsRegister] Called CrazyGames.SDK.user.showAuthPrompt()")):console.error("[AppWithUnity.showSettingsRegister] CrazyGames SDK not available");return}console.log("[AppWithUnity.showSettingsRegister] NOT on CrazyGames - Opening register modal"),l()}},[n,w,t,r,l]),a.useEffect(()=>{const o=s=>{s.detail&&s.detail.mode&&(s.detail.mode==="login"?r():s.detail.mode==="signup"&&l())};return document.addEventListener("switchAuthMode",o),()=>{document.removeEventListener("switchAuthMode",o)}},[r,l]),a.useEffect(()=>{const o=s=>{let i=s.detail;if(!i||!i.discordUser){const c=sessionStorage.getItem("pendingDiscordUser");c&&(i=JSON.parse(c),sessionStorage.removeItem("pendingDiscordUser"))}if(i&&i.discordUser){const{discordUser:c,suggestedUsername:k,access_token:_}=i;C(c,k,_)}};return window.addEventListener("showDiscordFusionModal",o),()=>{window.removeEventListener("showDiscordFusionModal",o)}},[C]),a.useEffect(()=>(window.showDiscordVerificationModal=()=>{console.log("[AppContent] showDiscordVerificationModal called from Unity"),d()},()=>{delete window.showDiscordVerificationModal}),[d]),a.useEffect(()=>{const o=s=>{if(s.origin!==window.location.origin)return;s.data.type==="DAILY_SPIN_NOT_VERIFIED"&&(console.log("[AppContent] Received NOT_VERIFIED error, showing Discord verification modal"),d())};return window.addEventListener("message",o),()=>{window.removeEventListener("message",o)}},[d]),e.jsxs("div",{className:"app-container",children:[e.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:0},children:e.jsx(q,{version:g,dailyStreak:p,unityFiles:h})}),t==="settings"&&e.jsx(ae,{}),t==="release-notes"&&e.jsx(re,{}),t==="level-progress"&&e.jsx(le,{}),e.jsx(M,{type:"login",isOpen:y,onClose:m,onConfirm:()=>m()}),e.jsx(M,{type:"signup",isOpen:f,onClose:u,onConfirm:()=>u()}),e.jsx(de,{isOpen:S,onClose:v}),e.jsx(ce,{}),e.jsx(xe,{isOpen:O,onClose:x}),e.jsx(Ae,{isOpen:A,onClose:j}),e.jsx(je,{isOpen:L,onClose:U}),e.jsx(Le,{isOpen:D,onClose:P}),e.jsx(Ue,{isOpen:z,onClose:T}),e.jsx(De,{isOpen:V,onClose:B}),e.jsx(ge,{isOpen:R,onClose:E}),e.jsx(pe,{isOpen:I,onClose:W}),e.jsx(he,{isOpen:N,onClose:G}),e.jsx(we,{isOpen:K,onClose:b,ticketUuid:F}),e.jsx(me,{}),e.jsx(Pe,{richColors:!0,position:"top-center"})]})}function Ke({version:g="3.2.4.5",dailyStreak:p=223,unityFiles:h}){return e.jsx(Q,{client:Re,children:e.jsx(ue,{children:e.jsx(J,{children:e.jsx(Z,{children:e.jsx(Me,{children:e.jsx($,{children:e.jsx(H,{children:e.jsx(X,{children:e.jsx(ee,{children:e.jsx(ye,{children:e.jsx(fe,{children:e.jsx(oe,{children:e.jsx(Ee,{version:g,dailyStreak:p,unityFiles:h})})})})})})})})})})})})})}export{Ke as A};
