import{_ as Z}from"./TurnstileProvider--U56YGUH.js";import{r as c,e as b,j as u}from"./client-DAUkLRV6.js";import"./UserContext-BpQKg0jV.js";import"./createLucideIcon-C4Jmhpft.js";import"./clsx-B-dksMZM.js";import"./users-DWxWVq8m.js";import"./globe-fBbbh6AL.js";import"./chevron-up-C0rOsiR-.js";import"./index-BpOnca1f.js";import"./calendar-DeRS7_-h.js";import"./crown-DZ50VFaU.js";import"./flame-BelwWMew.js";var B={},k={},A={};Object.defineProperty(A,"__esModule",{value:!0});A.useUnityCanvasId=void 0;var ee=c,te=0,ne="react-unity-webgl-canvas",re=function(n){if(n.id!==void 0)return n.id;var o=(0,ee.useMemo)(function(){return[ne,++te].join("-")},[]);return o};A.useUnityCanvasId=re;var P={},S={};Object.defineProperty(S,"__esModule",{value:!0});S.UnityLoaderStatus=void 0;var V;(function(n){n.Idle="Idle",n.Loading="Loading",n.Loaded="Loaded",n.Error="Error"})(V||(S.UnityLoaderStatus=V={}));var _={};Object.defineProperty(_,"__esModule",{value:!0});_.isBrowserEnvironment=void 0;_.isBrowserEnvironment=typeof window<"u"&&typeof document<"u";var ae=b&&b.__awaiter||function(n,o,t,i){function a(e){return e instanceof t?e:new t(function(s){s(e)})}return new(t||(t=Promise))(function(e,s){function d(l){try{r(i.next(l))}catch(v){s(v)}}function y(l){try{r(i.throw(l))}catch(v){s(v)}}function r(l){l.done?e(l.value):a(l.value).then(d,y)}r((i=i.apply(n,o||[])).next())})},ie=b&&b.__generator||function(n,o){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,a,e,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=d(0),s.throw=d(1),s.return=d(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function d(r){return function(l){return y([r,l])}}function y(r){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,r[0]&&(t=0)),t;)try{if(i=1,a&&(e=r[0]&2?a.return:r[0]?a.throw||((e=a.return)&&e.call(a),0):a.next)&&!(e=e.call(a,r[1])).done)return e;switch(a=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,a=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=o.call(n,t)}catch(l){r=[6,l],a=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(P,"__esModule",{value:!0});P.useUnityInstance=void 0;var se=c,oe=S,ue=_,le=function(n,o,t,i){(0,se.useEffect)(function(){(function(){return ae(void 0,void 0,void 0,function(){var a,e;return ie(this,function(s){switch(s.label){case 0:if(ue.isBrowserEnvironment===!1)return[2];if(n!==oe.UnityLoaderStatus.Loaded||o===null)return i.setUnityInstance(null),i.setInitialisationError(null),[2];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,window.createUnityInstance(o,t,i.setLoadingProgression)];case 2:return a=s.sent(),i.setUnityInstance(a),i.setInitialisationError(null),[3,4];case 3:return e=s.sent(),i.setUnityInstance(null),i.setInitialisationError(e),[3,4];case 4:return[2]}})})})()},[n,o,t,i])};P.useUnityInstance=le;var $={};Object.defineProperty($,"__esModule",{value:!0});$.useUnityArguments=void 0;var ce=c,de=function(n){return(0,ce.useMemo)(function(){return{dataUrl:n.unityProvider.unityConfig.dataUrl,frameworkUrl:n.unityProvider.unityConfig.frameworkUrl,codeUrl:n.unityProvider.unityConfig.codeUrl,streamingAssetsUrl:n.unityProvider.unityConfig.streamingAssetsUrl,memoryUrl:n.unityProvider.unityConfig.memoryUrl,symbolsUrl:n.unityProvider.unityConfig.symbolsUrl,workerUrl:n.unityProvider.unityConfig.workerUrl,companyName:n.unityProvider.unityConfig.companyName,productName:n.unityProvider.unityConfig.productName,productVersion:n.unityProvider.unityConfig.productVersion,webglContextAttributes:n.unityProvider.unityConfig.webglContextAttributes||{},cacheControl:n.unityProvider.unityConfig.cacheControl||function(){return"must-revalidate"},devicePixelRatio:n.devicePixelRatio||1,autoSyncPersistentDataPath:n.autoSyncPersistentDataPath,matchWebGLToCanvasSize:typeof n.matchWebGLToCanvasSize=="boolean"?n.matchWebGLToCanvasSize:!0,disabledCanvasEvents:n.disabledCanvasEvents||["contextmenu","dragstart"],print:function(o){},printErr:function(o){}}},[])};$.useUnityArguments=de;var O={};Object.defineProperty(O,"__esModule",{value:!0});O.useUnityLoader=void 0;var z=c,ve=_,x=S,fe=function(n){var o=(0,z.useState)(x.UnityLoaderStatus.Loading),t=o[0],i=o[1];return(0,z.useEffect)(function(){if(ve.isBrowserEnvironment!==!1){if(n.loaderUrl===null){i(x.UnityLoaderStatus.Idle);return}var a=window.document.querySelector('script[src="'.concat(n.loaderUrl,'"]'));a===null?(a=window.document.createElement("script"),a.type="text/javascript",a.src=n.loaderUrl,a.async=!0,a.setAttribute("data-status","loading"),window.document.body.appendChild(a),a.addEventListener("load",function(){return a==null?void 0:a.setAttribute("data-status","loaded")}),a.addEventListener("error",function(){return a==null?void 0:a.setAttribute("data-status","error")})):i(a.getAttribute("data-status")==="loaded"?x.UnityLoaderStatus.Loaded:x.UnityLoaderStatus.Error);var e=function(s){return i(s.type==="load"?x.UnityLoaderStatus.Loaded:x.UnityLoaderStatus.Error)};return a.addEventListener("load",e),a.addEventListener("error",e),function(){a!==null&&(a.removeEventListener("load",e),a.removeEventListener("error",e),a.remove())}}},[n.loaderUrl]),t};O.useUnityLoader=fe;Object.defineProperty(k,"__esModule",{value:!0});k.Unity=void 0;var H=c,Q=c,ye=A,me=P,ge=$,be=O,he=(0,Q.forwardRef)(function(n,o){var t=(0,Q.useRef)(null),i=(0,ye.useUnityCanvasId)(n),a=(0,ge.useUnityArguments)(n),e=(0,be.useUnityLoader)(n.unityProvider.unityConfig);return(0,me.useUnityInstance)(e,t.current,a,n.unityProvider),(0,H.useImperativeHandle)(o,function(){return t.current}),(0,H.createElement)("canvas",{ref:t,id:i,style:n.style,className:n.className,tabIndex:n.tabIndex})});k.Unity=he;var R={},C={};Object.defineProperty(C,"__esModule",{value:!0});C.errorMessages=void 0;var Ue={genericNoUnityInstance:"No Unity Instance found.",requestFullscreenNoUnityInstance:"Unable to Set Fullscreen while Unity is not Instantiated.",requestPointerLockNoUnityInstanceOrCanvas:"Unable to Request Pointer Lock while Unity is not Instantiated or the Canvas is not found.",sendMessageNoUnityInstance:"Unable to Send Message while Unity is not Instantiated.",quitNoUnityInstance:"Unable to Quit Unity while Unity is not Instantiated.",screenshotNoUnityInstanceOrCanvas:"Unable to Take Screenshot while Unity is not Instantiated or Canvas is not available.",noEventListener:"Unable to find Event Listener in Event System for Event"};C.errorMessages=Ue;var T={},F=b&&b.__spreadArray||function(n,o,t){if(t||arguments.length===2)for(var i=0,a=o.length,e;i<a;i++)(e||!(i in o))&&(e||(e=Array.prototype.slice.call(o,0,i)),e[i]=o[i]);return n.concat(e||Array.prototype.slice.call(o))};Object.defineProperty(T,"__esModule",{value:!0});T.useEventSystem=void 0;var I=c,we=C,xe=_,M=[],pe=function(n){for(var o=[],t=1;t<arguments.length;t++)o[t-1]=arguments[t];var i=void 0;return M.forEach(function(a){i=a.apply(void 0,F([n],o,!1))}),i};xe.isBrowserEnvironment===!0&&(window.dispatchReactUnityEvent=pe);var _e=function(){var n=(0,I.useRef)([]),o=(0,I.useCallback)(function(a,e){n.current=F(F([],n.current,!0),[{eventName:a,callback:e}],!1)},[n]),t=(0,I.useCallback)(function(a,e){n.current=n.current.filter(function(s){return s.eventName!==a&&s.callback!==e})},[n]),i=(0,I.useCallback)(function(a){for(var e=[],s=1;s<arguments.length;s++)e[s-1]=arguments[s];var d=n.current.find(function(y){return y.eventName===a});if(typeof d>"u"){console.warn(we.errorMessages.noEventListener,{eventName:a});return}return d.callback.apply(d,e)},[n]);return(0,I.useEffect)(function(){return M.push(i),function(){M.splice(M.indexOf(i),1)}},[i]),{addEventListener:o,removeEventListener:t}};T.useEventSystem=_e;var W={};Object.defineProperty(W,"__esModule",{value:!0});W.useNullableState=void 0;var Le=c,Ee=function(n){return(0,Le.useState)(n||null)};W.useNullableState=Ee;var Ie=b&&b.__awaiter||function(n,o,t,i){function a(e){return e instanceof t?e:new t(function(s){s(e)})}return new(t||(t=Promise))(function(e,s){function d(l){try{r(i.next(l))}catch(v){s(v)}}function y(l){try{r(i.throw(l))}catch(v){s(v)}}function r(l){l.done?e(l.value):a(l.value).then(d,y)}r((i=i.apply(n,o||[])).next())})},Se=b&&b.__generator||function(n,o){var t={label:0,sent:function(){if(e[0]&1)throw e[1];return e[1]},trys:[],ops:[]},i,a,e,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=d(0),s.throw=d(1),s.return=d(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function d(r){return function(l){return y([r,l])}}function y(r){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,r[0]&&(t=0)),t;)try{if(i=1,a&&(e=r[0]&2?a.return:r[0]?a.throw||((e=a.return)&&e.call(a),0):a.next)&&!(e=e.call(a,r[1])).done)return e;switch(a=0,e&&(r=[r[0]&2,e.value]),r[0]){case 0:case 1:e=r;break;case 4:return t.label++,{value:r[1],done:!1};case 5:t.label++,a=r[1],r=[0];continue;case 7:r=t.ops.pop(),t.trys.pop();continue;default:if(e=t.trys,!(e=e.length>0&&e[e.length-1])&&(r[0]===6||r[0]===2)){t=0;continue}if(r[0]===3&&(!e||r[1]>e[0]&&r[1]<e[3])){t.label=r[1];break}if(r[0]===6&&t.label<e[1]){t.label=e[1],e=r;break}if(e&&t.label<e[2]){t.label=e[2],t.ops.push(r);break}e[2]&&t.ops.pop(),t.trys.pop();continue}r=o.call(n,t)}catch(l){r=[6,l],a=0}finally{i=e=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}};Object.defineProperty(R,"__esModule",{value:!0});R.useUnityContext=void 0;var g=c,p=C,Ce=T,X=W,je=function(n){var o=(0,X.useNullableState)(),t=o[0],i=o[1],a=(0,g.useState)(0),e=a[0],s=a[1],d=(0,g.useState)(!1),y=d[0],r=d[1],l=(0,X.useNullableState)(),v=l[0],q=l[1],j=(0,Ce.useEventSystem)(),L=(0,g.useRef)({setLoadingProgression:s,setInitialisationError:q,setUnityInstance:i,setIsLoaded:r,unityConfig:n}),D=(0,g.useCallback)(function(m){if(t===null){console.warn(p.errorMessages.requestFullscreenNoUnityInstance);return}t.SetFullscreen(m===!0?1:0)},[t]),G=(0,g.useCallback)(function(){if(t===null||typeof t.Module.canvas>"u"){console.warn(p.errorMessages.requestPointerLockNoUnityInstanceOrCanvas);return}return t.Module.canvas.requestPointerLock()},[t]),N=(0,g.useCallback)(function(m,U,E){if(t===null){console.warn(p.errorMessages.sendMessageNoUnityInstance);return}t.SendMessage(m,U,E)},[t]),f=(0,g.useCallback)(function(m,U){if(t===null||typeof t.Module.canvas>"u"){console.warn(p.errorMessages.screenshotNoUnityInstanceOrCanvas);return}return t.Module.canvas.toDataURL(m,U)},[t]),h=(0,g.useCallback)(function(){return t===null?(console.warn(p.errorMessages.quitNoUnityInstance),Promise.reject()):t.Quit()},[t]),w=(0,g.useCallback)(function(){return Ie(void 0,void 0,void 0,function(){var m;return Se(this,function(U){switch(U.label){case 0:return t===null||typeof t.Module.canvas>"u"?(console.warn(p.errorMessages.genericNoUnityInstance),[2,Promise.reject()]):(m=t.Module.canvas,document.body.appendChild(m),m.style.display="none",[4,h()]);case 1:return U.sent(),m.remove(),[2]}})})},[t]);return(0,g.useEffect)(function(){r(e===1)},[e]),{unityProvider:L.current,loadingProgression:e,initialisationError:v,isLoaded:y,UNSAFE__unityInstance:t,requestFullscreen:D,requestPointerLock:G,sendMessage:N,takeScreenshot:f,unload:h,UNSAFE__detachAndUnloadImmediate:w,addEventListener:j.addEventListener,removeEventListener:j.removeEventListener}};R.useUnityContext=je;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.useUnityContext=n.Unity=void 0;var o=k;Object.defineProperty(n,"Unity",{enumerable:!0,get:function(){return o.Unity}});var t=R;Object.defineProperty(n,"useUnityContext",{enumerable:!0,get:function(){return t.useUnityContext}})})(B);const Y=["Loading game...","Gathering all resources...","Initializing game world...","Loading character data...","Preparing adventure...","Almost ready..."],Ne=()=>{const[n,o]=c.useState(0),[t,i]=c.useState(!0);return c.useEffect(()=>{const a=setInterval(()=>{i(!1),setTimeout(()=>{o(e=>(e+1)%Y.length),i(!0)},200)},1200);return()=>clearInterval(a)},[]),u.jsx("div",{className:"min-h-[24px] flex items-center",children:u.jsx("p",{className:`game-text-secondary text-2xl font-bold transition-opacity duration-200 ${t?"opacity-100":"opacity-0"}`,children:Y[n]})})},Me=({progress:n})=>{const t=n/100*27;return u.jsxs("div",{className:"w-full space-y-3",children:[u.jsx("div",{className:"loading-bar-container",children:u.jsx("div",{className:"loading-bar-fill",style:{width:`${n}%`,animation:n>0?"pulse-glow 2s infinite":"none"}})}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx(Ne,{}),u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsxs("div",{className:"game-text-muted text-sm font-mono",children:[t.toFixed(2),"MB / ",27,"MB"]}),u.jsxs("div",{className:"game-text-secondary font-mono text-2xl font-bold",children:[Math.round(n),"%"]})]})]})]})},ke=({version:n="3.3.2"})=>u.jsx("div",{className:"glass-card px-6 py-4 inline-block",children:u.jsxs("span",{className:"game-text-primary text-xl font-bold",children:["Version ",n]})}),Ae=({streakCount:n=218})=>u.jsx("div",{className:"glass-card px-6 py-4 inline-block",children:u.jsxs("div",{className:"flex flex-col items-center text-center",children:[u.jsxs("div",{className:"game-text-primary text-xl font-bold",children:["ðŸ”¥ ",n," Days"]}),u.jsx("div",{className:"game-text-muted text-sm font-normal",children:"of Daily Updates!"})]})});function Pe({progress:n,visible:o,version:t="v3.2.4.3-dev",dailyStreak:i=3}){const[a,e]=c.useState({x:0,y:0});return c.useEffect(()=>{const s=d=>{const y=(d.clientX/window.innerWidth-.5)*20,r=(d.clientY/window.innerHeight-.5)*20;e({x:y,y:r})};return window.addEventListener("mousemove",s),()=>window.removeEventListener("mousemove",s)},[]),u.jsxs("div",{className:"loading-screen-container",style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1e3,overflow:"hidden",background:"#0a0a0a",opacity:o?1:0,transform:o?"scale(1)":"scale(1.5)",transition:"opacity 0.5s ease, transform 0.5s ease",pointerEvents:o?"auto":"none"},children:[u.jsx("div",{className:"loading-background",style:{position:"absolute",inset:0,backgroundImage:"url(/images/SuperTripLand.webp)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",transform:`scale(1.1) translate(${a.x}px, ${a.y}px)`,transition:"transform 0.1s ease-out"}}),u.jsxs("div",{className:"loading-overlay",style:{position:"relative",width:"100%",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between"},children:[u.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",padding:"2rem"},children:[u.jsx(ke,{version:t}),u.jsx(Ae,{streakCount:i})]}),u.jsx("div",{style:{flex:1}}),u.jsx("div",{style:{width:"100%"},children:u.jsx("div",{className:"glass-card",style:{padding:"1rem 2rem",background:"rgba(0, 0, 0, 0.25)",backdropFilter:"blur(20px)",borderRadius:0,borderTop:"1px solid rgba(255, 255, 255, 0.2)",borderLeft:"none",borderRight:"none",borderBottom:"none"},children:u.jsx(Me,{progress:n*100})})})]})]})}const He=c.forwardRef(function({version:o="3.x.x.x",dailyStreak:t=999,unityFiles:i},a){if(!i)return null;const[e,s]=c.useState(!0),[d,y]=c.useState(.1),[r,l]=c.useState(!1),v=c.useRef(null),q=c.useRef(Date.now()),{unityProvider:j,UNSAFE__unityInstance:L,loadingProgression:D,isLoaded:G,unload:N}=B.useUnityContext(i);return c.useImperativeHandle(a,()=>({unload:async()=>{console.log("[UnityWithLoading] Unloading Unity instance..."),window.unityInstance=void 0,delete window.triggerAnimation,v.current&&(v.current.remove(),v.current=null);try{await N(),console.log("[UnityWithLoading] Unity unloaded successfully")}catch(f){console.error("[UnityWithLoading] Error unloading Unity:",f)}}}),[N]),c.useEffect(()=>(Z(()=>import("./styles-B49ME0VC.js"),[]).then(f=>{const h=document.createElement("style");h.id="loading-screen-styles",h.textContent=f.default,document.head.appendChild(h),v.current=h,console.log("[UnityWithLoading] Loading screen CSS injected")}),()=>{v.current&&(v.current.remove(),console.log("[UnityWithLoading] Loading screen CSS removed"))}),[]),c.useEffect(()=>{L&&(window.unityInstance=L,console.log("[UnityWithLoading] window.unityInstance set:",window.unityInstance),setTimeout(()=>{const f=document.querySelector("canvas");f&&(f.style.outline="none",f.style.border="none",f.style.boxShadow="none",f.setAttribute("tabindex","-1"),f.focus(),console.log("[UnityWithLoading] Canvas focused and outline removed"))},100))},[L]),c.useEffect(()=>{let f=.1;const h=setInterval(()=>{let w;if(r)w=1;else{const E=(Date.now()-q.current)/1e3;if(E<8)w=.1+.7*(E/8);else{const J=E-8,K=.8+.145*(1-Math.exp(-J/10));w=Math.min(K,.945)}}const m=w-f;f+=m*(r?.15:.12),y(f)},16);return()=>clearInterval(h)},[r]),c.useEffect(()=>(window.triggerAnimation=()=>{console.log("[UnityWithLoading] triggerAnimation called by Unity - completing to 100%"),l(!0),setTimeout(()=>{s(!1),v.current&&(v.current.remove(),v.current=null,console.log("[UnityWithLoading] Loading screen CSS removed after Unity loaded"))},300),typeof window.triggerSorryPopup=="function"&&setTimeout(()=>{var f;(f=window.triggerSorryPopup)==null||f.call(window)},500)},()=>{delete window.triggerAnimation}),[]),u.jsxs(u.Fragment,{children:[u.jsx(Pe,{progress:d,visible:e,version:o,dailyStreak:t}),u.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",zIndex:1,opacity:e?0:1,transition:"opacity 0.5s ease",pointerEvents:e?"none":"auto"},children:u.jsx(B.Unity,{unityProvider:j,style:{width:"100%",height:"100%",display:"block"},tabIndex:-1,devicePixelRatio:1.5})})]})});export{He as default};
